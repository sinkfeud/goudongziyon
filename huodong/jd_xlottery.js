/*
新年开新抽奖

cron:33 7 * * *
============Quantumultx===============
[task_local]
#新年开新抽奖
33 7 * * * jd_xlottery.js, tag=新年开新抽奖, enabled=true

*/
const $ = new Env('新年开新抽奖');
var _0xodr='jsjiami.com.v6',_0xodr_=['‮_0xodr'],_0x550c=[_0xodr,'wpbChcO0w4LCgA==','Y04Fw7nDpUTDsHfCrATDjwrDv0dfwoEnKnk7wrrDkMKxwoY9PsOxJQ==','wpXDpmttwoE=','w4/DnFHDtMKT','w4Iaw6g2SwsR','wqrCjFdCfw==','wrRAw5TCtQk=','w7vCuMKNByY=','wozCsjXClWPDvcK+wqoNw7fClg==','Cm7Dp2oid1s1wpLCrBNSw5dM','IggAw7sVYAlew7MSPQ==','w7oXaUXCtz4DNMOWw4VhI0p9','A8OoWQ==','UuiMgOW8kw==','wpxPw7RTDMKmwoHCq8KnDkdbORzDjg==','ICdZU8OzLiEtw7dp','NQkUw60d','FXTDow==','Cm/DtmApY0EBwo4=','woBTScKf','BnFnw7fDqA==','DsK1OcKnJw==','wpdQw7XCgxk=','UkjDiR3ChQ==','Cm7DpkooYE0=','wpLCkyrClWA=','CEZiwobCoG7Cqg/DpMOJwqE=','w5nCiDg9CsKlYgkpVwNrIsOQ','bMO+wrQ=','w6DojJDlvbM=','IRgWw7QTbQ5uw5kRJsONAhI+','SVnDqQnCtCIQEFnDrQcYWcOAw5E=','wrXCkMKuRSnDs8KYwo0kw44=','wqYQwpMU','wpHCgsO6','Y8KUcw==','wrbCgMK4Si/DvsKiwpUNw44Hw74Rw4hZ','wrEmw6nCncOCwoVRGcKbXsKcw4HDkcKRWA==','wpUgP8Ovw6zDgA9Zw47DiQ==','GcKWwpc=','wqY8KsOCw7U=','b8K+Z8Ofw5c=','wrbCri7Cm3s=','wq7DisOgwrLCocKow6A=','wqLClsKQbzA=','w5XCj8KkADJO','HMOuFl5WwpPDvcO8eFUd','wrMmw6vCkMOTwp9WMsK6TMKJw5LDnMKO','wonCi8OX','wpDDqMOG','w6zojZ/lvoE=','w4ErWhItOcKvPQ==','woLDjl9BwrYWwpzCvS/CkQ==','LUcoWMKMfmPDp8KU','AxlPMlc=','wobCjMK7aDA=','wq88JMOhw7Q=','Fz9XE2c=','JwtcEmBKw7k=','w7TljLjkuqfmiYnlpYc=','w7gKQcOBfQ==','w4wtw4nDhcKU','ZFo0w5AQbg9Cw5wnNcKUIRUOwqstw4kKG00Xw7pHwprDu0pe','wrjDkkRPwq4=','w6zCu8Opw5s3A8OPel0=','w7/CsMKdZg==','CMKkWzgK','w7M8w6HDpsKQ','w4vCjTJwAsO4ez9iQw10','wp/CpzLCmHjDusKswpcKw77Cl8KYw4vDssKRO27CgWrCo2zCp1dEwoTCp8OBOsO6wq7Dm8KiNw==','wp9GVMKbOkbCkG1IwrBOw5vDrjXDlEckw6vChR4tDjo=','dMKPOcOPw7E6bsKbVcO3OQPDiMKSKy/CnEPDuw==','wpXDr8OVw4nChMOxOcOpwqPCj8KrZ8K5TjfDtQbDgAI3KFN+woo=','X1bDoRfDrGsADHvDpBINVcKAwoLCpmM=','G2zDg1Mf','w4Upw6wBfA==','wocBw4LClsOv','wqQcJ8Omw5s=','w5XCv1ADw4LDj10VIW7Dhy9ew5wUw5vDsMKIwqkLw6LDm8Ocw4rDmlbCiynDiS0aDMKTwqlqN8Kyw4Usw5lfwolew43Cj34=','YMOOw75jw5DCvcO+wqd2BB4mUW7Dl8OewqBIw7Aww6MVwqY+woLDljk=','woBdw5nCrgA=','wr1Mw57CuMOKbsOhfn3DtVs=','w6TCisKh','w7/CvBAvAA==','RMKkSw==','w78QTsOxRA==','w75Rw4E=','wocxwrUyDTUFfBJPw44Iw64=','w6gMbw==','DQcsw5VS','w7xaw4PCu8OFJ8Kx','CMKJPsKQLj7CiA==','S8O6w5tL','woBww7jCgB0=','wq9zw5DCkAk=','wrDCh2VM','KsKCBcKTOw==','wqTCkC/CrWU=','EEnDjFk9','wqzCh3E=','w7oWeE/CvCoZAMOK','w7PCoMO8','b8Ofw6Nv','GG3DmC7orLfmsInlpZXotYzvvJHorb/morPmnpznvaHotYPpha/orJE=','LsOYw6BxeQ==','wq4yw6XClg==','6K2a5Yiu6ZqE5oWN5ZyoQQVmwoDDoei8meWFuOaigeS+m+aXhuWGtuWttSjluJjorKbpgoTov4fohp3mnZ7ljL/oj77lj57CvsKCSEkfMQ==','woXChllfTg==','T8K0Y8O2w7w=','GQ9YSsOy','FlgSWMK4','OmQtScKM','w7vDsHXDnsKv','csO0wqTDuzfCjsODWELDsAk=','K2di','wq0gw68=','w6zoj6TlvJ8=','w67CusO6w5wtDcOSZQ==','AitONlU=','MgRmBGI=','woMTBMOow4o=','6K6g5Yu96ZuC5oau5Z69NcOpOMKJNei9q+WEheajq+S/meaVleWFiuWvuBXlu7borqzpg4vovaboh4jmn6Tlj6Poj7Dljb4hHm7Dh2rChg==','BcKgwodXRg==','woLCl8OAC3o=','wr7DgsKQHynDuMO8','M3Fywq/Cng==','woFvw413AA==','w5kbw74FV1VbwpNPw6PCusOxLMKpw6hhIsOBTE5/wqvCnVjCo8KQw5fDkRwuwqXCnlHDn8Ozw77CrkvDoEHDnMOOCcO6wqgPMMKIw71NPlBjXsONwq/DvsO1FFU/','w74TJEzCtmMTCcOe','ekJd','aSdQw6jDhhfDjMOIRx/Ch1zDrg==','wpTCsyPChGHCosKkwrMLw77Cl8OSwojDpsOIeDfCmDfDvSrDpEkKwpjCrsOQI8O2wrPDlMOoZ8KPwqhuccOxw7lXwqfDjXVVCmYZwqfDs3bDqywgwpjCknbDkT5mw6XDrzwCI2vDvlYVHMOJw5nCi3rDkcO+wo/CqUNdahnDhsOJwp0LwoQ7w6t7PRrDgsOpOWVUw419fMKfBHMYwoMfHsOLJ8OVIFRDbUodw5fChz/ChShtw5g3w7/DlMOMNXbDlgnDs8KVw7fDgcKVw5LDicKhw4lhw5fDugRwbMOADcKcwrZ3fHx5w6sew6JOwqLCuwY=','wrXDi8O2woHCvcO2wqrDg1A8X8K+w650LMOSFcObw4c2w5XDkTIqKVkbwq8zSMORw4zCpXIow4XDozPCnkodShViwoEJZXXDgEIXEgAsTwPChWw=','wqDCj8KwVHfCt8Kywokvw4cSw6sdwogKe2c=','OUoicMK7','w6UoXcOHXA==','w7zCqMOhw50h','w7nChcKCRCw=','w4U8TAgf','NjpzJGk=','w43Dn3nDpMKL','wpXCsifChDzDuMKhwooVw7Q=','w63Cv8KC','P8K9wq9vW8OsWy02EUPCssOw','wr12f8K+GjnDrR15woVkw7HDnw==','GytGBGc=','wpLCpsKcdgTDlsKRwqkHw78=','acKCYMOow55idQ==','wooXw53Csg==','YsOiwobDvzA=','w41xw7LCrMOc','c8OSwr3DvT8=','DMKxwoRbUQ==','DsO9w694ZA==','K1wdXMK3','Pi1Jd8OzOA==','HsOuTTA=','wo7CtjDCh3Q=','woUhw7/CqsOz','w5bCvcOTw7cI','P1Fiwr7Clw==','FGJXwrHCtw==','w5wxXDkrIg==','wrnDmWBlwpU=','wpTDilxB','w5LCu8OUEA==','wp55w6nCuBjChsOjbgdEB8OKJiA=','w6TCmxAxHQ==','w4Mkw5TDng==','w6sDeUPCmyMWCQ==','dEQFw4TDnQ==','w6TCvsKT','wrfClMKrVz4=','DcKgTw==','w6bCsMKZdw==','w6TCvsKTVzrDow==','wqzCvU5yQg==','YMOYw6tww7M=','w5/Ctw8zKg==','XG8pw67Dsg==','wqVCw6ZFMQ==','wogrw7vCi8O/','JhtJMH1Kw69Bwo0gRQ==','wr4AwokEOwMkcTZ/w6o0w57Dlw==','w7TDkn8=','FGjDow==','w5zCpGosdGoeZ8KOw7fDvnzCrhnCjA==','CyZ+eMOL','w6TCnsKdXx4=','EsOYw6M=','5Lmx5Lqj5p6P5YmQ5Zqm6K2z6ZWr5pac5o2W5Lmp56mI77+X6Ky35qOZ5p+n6IWS6Lua6K2L5aaj57yI57mk5oC75Yeq','PAIQ','w6UNbQ==','5Lu85Lmx5p265Yi75ZiP6K676ZaU5pWn5o+z5LmO56io776g6K6c5qK+5p6o6ISq6Lux6Kyg5aW/57yi57qm5oOg5YSF','wo7CmcOvw5HCicK8','wq3DnsKUMA8=','6K2v5YmC6ZqX5oap5Z+0wpXCn8OBw5zCi+i8s+WFveahhOS+teaWsOWEqeWugMK85bi36Kyw6YCp6Lyn6ISE5p+e5Y+N6I+S5Y+QJsK4FWFtw7M=','w73CrsOrIFs=','w5ARw4jDmcKD','EsKJfRYL','wpbDvsOYw4o=','w5Qww4PDnMKWRxHCqsKnBhZLO8KC','LFYtUMKQfXnDiMKDYRw=','wrPojbjlvIw=','Nn1kw5XDtyzDp8OwRD/CvWnDlGbCtQ==','Nn1kw5XDtyzDp8Ow','w4/CrlMSw4PCkTxbLXs=','JkM/ZcKP','YMOHw75Gw70=','woBJw7I=','wpPCjMOww50=','wqkkw6zCl8OY','F8OEw4pzVwA=','wqs2w7HCgA==','wotVw6d4GcKswp0=','fsKSZ8Ok','C8OlFw==','wrfCqcOCw7zCosKZAcOH','wqYyw6TCgMOT','AsO0WQ==','Z8O0wqfDviTCnsOR','CcOuFVtFwoPDrw==','wrV3w7XCnAbCjcO5WFo=','HUZhwoPCs37CuA==','woTCmsK2TzLDssKlwqYN','A8OqEQ==','JGdqw5DDqiA=','w4vCuGc2ZXE=','wrXDi8O2woHCvcO2wqrDg1o2U8K1w650LMOSFcObw4c2w5XDkT02AlMbwrI/WMOXw6rCpnNjw5zCribClFEaGgg=','44Kp5oyw56e544GU6K635YW06IyU5Y+J5Luc5Lu+6LS85YyB5LquOMOKw7jDkV3DkzTnmJbmjJbkvp/nlp07VsOXwqcbw6nnmofkuoPkuIbnr4/liqLoj4PljIA=','AGFiw7TDkA==','eFIcw5zDmVvDgMO7wrouYcOrdsObw54zFzJ7V8KgwrsVQx00w6vCg1AEw4AxCHsdw5MIw5PDvmjCtMKyBQ==','wptXTsKMPRQ=','PWcuaMKD','DyUww5lp','w6QMfcONbw==','wpbDscOAw5DCpw==','GgxCwobCgEvDheW/lOWkk+OBm+S6rOS6mei1vuWNgQ==','wozCisOUFGU=','b8OXw61hw7rDocOwwq0=','LGjDoXsJZUUC','w5rCgQIKw65Yw7jDtmjDvg==','B8OocjfClMO7wrM=','w4kkw43Dmg==','5LiR5LuX6LSC5Y6E','wp5cRMKOMQ==','w7VWw5TCtMOqMsK9Kg==','O8OoWyrCvcOzwrB7','woPorpXph4fmlpbnmqnlvJjoj4fljrDCucOadCVefXAfw4vDiF1swrQtNMKpwpvCj3nDu8KeQ8Omw6PDgBnClyIvCXtNC8KVw4zCoxvDombDjcKYGcK7MQ==','w7JMw7nCsMOANg==','wo7DvsOPw53CucKkYsKvwrXChA==','w7Vew5rCug==','w6UtXg4XMcK2IQ==','5LiB5LuN6LSt5Y61','wpTCg8O5w53Cnw==','w43Djn3DlMKSwrbCncOc','ZOitrOmHs+aXqOeaiOW/h+iNquWPiHfDtcOTTsOuwrE=','w53CsMOBGE4=','w64DbcOLfw==','w4HCvmw=','D8KuRTo=','wrTCneWkqei2g8O9w7flja/lmZnCrMOY','w4Esw47DnsKfWBs=','w5QxVRk=','EMK6TS09JUltJMO/PnhFwph8HMOLwqjDoCM=','WsOXdgDCg8Khwqspe8OYwotPw5XCpMOiV2vCvsKeHiHCs8Knwqg5w5rDpnI=','dEkhw4LDngTCncK1wrs/acOzPcO3woMqGnt2VcKow7oD','O8OoXQnCtcOowopSWsOQw7YWw4PCvcOjXD/Dg8KAQyjCtcO8wrcmw47Dqw==','XcK4UQ4Tw4fCuMKALgs=','PcOUJMK9wogmIsOKScKG','H11Pw4PDsA==','Fnsvw63Dvg==','w6XCqGctag==','w5oScAkg','jsjPiPaOmIDi.ELcom.v6OxXPbMhTNWe=='];if(function(_0x39d867,_0x3bc810,_0x48e493){function _0x554bec(_0x1a77f7,_0x1f4364,_0xbd3cd5,_0x17bbc2,_0x4010b5,_0x2f4dca){_0x1f4364=_0x1f4364>>0x8,_0x4010b5='po';var _0xd23621='shift',_0x2101a4='push',_0x2f4dca='‮';if(_0x1f4364<_0x1a77f7){while(--_0x1a77f7){_0x17bbc2=_0x39d867[_0xd23621]();if(_0x1f4364===_0x1a77f7&&_0x2f4dca==='‮'&&_0x2f4dca['length']===0x1){_0x1f4364=_0x17bbc2,_0xbd3cd5=_0x39d867[_0x4010b5+'p']();}else if(_0x1f4364&&_0xbd3cd5['replace'](/[PPOIDELOxXPbMhTNWe=]/g,'')===_0x1f4364){_0x39d867[_0x2101a4](_0x17bbc2);}}_0x39d867[_0x2101a4](_0x39d867[_0xd23621]());}return 0x11ce72;};return _0x554bec(++_0x3bc810,_0x48e493)>>_0x3bc810^_0x48e493;}(_0x550c,0x1e6,0x1e600),_0x550c){_0xodr_=_0x550c['length']^0x1e6;};function _0x56ae(_0x2d8f05,_0x4b81bb){_0x2d8f05=~~'0x'['concat'](_0x2d8f05['slice'](0x1));var _0x34a12b=_0x550c[_0x2d8f05];if(_0x56ae['UhBgkY']===undefined){(function(){var _0x36c6a6=typeof window!=='undefined'?window:typeof process==='object'&&typeof require==='function'&&typeof global==='object'?global:this;var _0x33748d='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x36c6a6['atob']||(_0x36c6a6['atob']=function(_0x3e4c21){var _0x5c685e=String(_0x3e4c21)['replace'](/=+$/,'');for(var _0x3e3156=0x0,_0x1e9e81,_0x292610,_0x151bd2=0x0,_0x558098='';_0x292610=_0x5c685e['charAt'](_0x151bd2++);~_0x292610&&(_0x1e9e81=_0x3e3156%0x4?_0x1e9e81*0x40+_0x292610:_0x292610,_0x3e3156++%0x4)?_0x558098+=String['fromCharCode'](0xff&_0x1e9e81>>(-0x2*_0x3e3156&0x6)):0x0){_0x292610=_0x33748d['indexOf'](_0x292610);}return _0x558098;});}());function _0xd7aec1(_0x230f38,_0x4b81bb){var _0x29929c=[],_0x5dd881=0x0,_0x550fbc,_0x18d5c9='',_0x4ce2f1='';_0x230f38=atob(_0x230f38);for(var _0x333808=0x0,_0x432180=_0x230f38['length'];_0x333808<_0x432180;_0x333808++){_0x4ce2f1+='%'+('00'+_0x230f38['charCodeAt'](_0x333808)['toString'](0x10))['slice'](-0x2);}_0x230f38=decodeURIComponent(_0x4ce2f1);for(var _0x2ab90b=0x0;_0x2ab90b<0x100;_0x2ab90b++){_0x29929c[_0x2ab90b]=_0x2ab90b;}for(_0x2ab90b=0x0;_0x2ab90b<0x100;_0x2ab90b++){_0x5dd881=(_0x5dd881+_0x29929c[_0x2ab90b]+_0x4b81bb['charCodeAt'](_0x2ab90b%_0x4b81bb['length']))%0x100;_0x550fbc=_0x29929c[_0x2ab90b];_0x29929c[_0x2ab90b]=_0x29929c[_0x5dd881];_0x29929c[_0x5dd881]=_0x550fbc;}_0x2ab90b=0x0;_0x5dd881=0x0;for(var _0x991246=0x0;_0x991246<_0x230f38['length'];_0x991246++){_0x2ab90b=(_0x2ab90b+0x1)%0x100;_0x5dd881=(_0x5dd881+_0x29929c[_0x2ab90b])%0x100;_0x550fbc=_0x29929c[_0x2ab90b];_0x29929c[_0x2ab90b]=_0x29929c[_0x5dd881];_0x29929c[_0x5dd881]=_0x550fbc;_0x18d5c9+=String['fromCharCode'](_0x230f38['charCodeAt'](_0x991246)^_0x29929c[(_0x29929c[_0x2ab90b]+_0x29929c[_0x5dd881])%0x100]);}return _0x18d5c9;}_0x56ae['pHngOn']=_0xd7aec1;_0x56ae['dTkZge']={};_0x56ae['UhBgkY']=!![];}var _0x981158=_0x56ae['dTkZge'][_0x2d8f05];if(_0x981158===undefined){if(_0x56ae['hJXckf']===undefined){_0x56ae['hJXckf']=!![];}_0x34a12b=_0x56ae['pHngOn'](_0x34a12b,_0x4b81bb);_0x56ae['dTkZge'][_0x2d8f05]=_0x34a12b;}else{_0x34a12b=_0x981158;}return _0x34a12b;};const notify=$['isNode']()?require('./sendNotify'):'';const jdCookieNode=$[_0x56ae('‮0','uZzh')]()?require('./jdCookie.js'):'';let cookiesArr=[],cookie='',message;if($['isNode']()){Object[_0x56ae('‮1','38sw')](jdCookieNode)[_0x56ae('‮2','[ghC')](_0x112789=>{cookiesArr[_0x56ae('‫3','to#V')](jdCookieNode[_0x112789]);});if(process[_0x56ae('‮4','YzX5')][_0x56ae('‮5','AGdJ')]&&process['env']['JD_DEBUG']===_0x56ae('‫6','38sw'))console[_0x56ae('‫7','alZY')]=()=>{};}else{cookiesArr=[$[_0x56ae('‫8','pteQ')]('CookieJD'),$[_0x56ae('‫9','YzX5')](_0x56ae('‮a','r%Vd')),...jsonParse($[_0x56ae('‮b','cEHm')](_0x56ae('‫c','[xL1'))||'[]')[_0x56ae('‮d','YzX5')](_0x459ab7=>_0x459ab7[_0x56ae('‮e','1@VP')])][_0x56ae('‮f','y1hR')](_0x5613e3=>!!_0x5613e3);}!(async()=>{var _0x46146f={'GigOS':_0x56ae('‫10','R$%2'),'bdZKt':function(_0x5c839e,_0x5990e1){return _0x5c839e<_0x5990e1;},'cTtYa':function(_0x2a5c2a,_0x304a57){return _0x2a5c2a(_0x304a57);},'kjaiP':function(_0x2302a2){return _0x2302a2();}};if(!cookiesArr[0x0]){$['msg']($['name'],_0x56ae('‮11','QB5r'),_0x46146f[_0x56ae('‮12','1@VP')],{'open-url':_0x56ae('‮13','c)52')});return;}for(let _0x1d03cf=0x0;_0x46146f['bdZKt'](_0x1d03cf,cookiesArr[_0x56ae('‮14','2$k]')]);_0x1d03cf++){if(cookiesArr[_0x1d03cf]){cookie=cookiesArr[_0x1d03cf];$['UserName']=_0x46146f[_0x56ae('‮15','T921')](decodeURIComponent,cookie[_0x56ae('‮16','1PQB')](/pt_pin=([^; ]+)(?=;?)/)&&cookie['match'](/pt_pin=([^; ]+)(?=;?)/)[0x1]);$[_0x56ae('‮17','U4Dx')]=_0x1d03cf+0x1;$['isLogin']=!![];$['nickName']='';message='';await _0x46146f[_0x56ae('‫18','4%An')](TotalBean);console['log'](_0x56ae('‫19','c)52')+$[_0x56ae('‮1a','A$)2')]+'】'+($[_0x56ae('‫1b','*WPM')]||$[_0x56ae('‫1c','z&gp')])+_0x56ae('‮1d','J)Rk'));if(!$[_0x56ae('‫1e','alZY')]){$['msg']($[_0x56ae('‫1f','m%3e')],'【提示】cookie已失效',_0x56ae('‫20','bJe^')+$[_0x56ae('‫21','2$k]')]+'\x20'+($[_0x56ae('‮22','Lk@q')]||$[_0x56ae('‮23','alZY')])+_0x56ae('‮24','yWm1'),{'open-url':'https://bean.m.jd.com/bean/signIndex.action'});if($[_0x56ae('‮25','Lk@q')]()){await notify[_0x56ae('‮26','4%An')]($[_0x56ae('‫27','Lk@q')]+'cookie已失效\x20-\x20'+$[_0x56ae('‫28','zS1i')],_0x56ae('‫29','y1hR')+$[_0x56ae('‮2a','AGdJ')]+'\x20'+$[_0x56ae('‫2b','@07l')]+_0x56ae('‫2c','alZY'));}continue;}await _0x46146f[_0x56ae('‫2d','fr02')](main);}}})()[_0x56ae('‫2e','U4Dx')](_0x337c29=>{$[_0x56ae('‫2f','y1hR')]('','❌\x20'+$[_0x56ae('‫30','Jd%h')]+_0x56ae('‫31','@07l')+_0x337c29+'!','');})[_0x56ae('‮32','m%3e')](()=>{$[_0x56ae('‫33','zS1i')]();});async function main(){var _0x2eaeeb={'edcwz':'京东服务器返回空数据','xJzlP':_0x56ae('‮34','Jd%h'),'AybLk':_0x56ae('‫35','alZY'),'Hyloj':'aceacesy20221130','jLKuy':function(_0x2ebed3,_0x167f89,_0x46f728){return _0x2ebed3(_0x167f89,_0x46f728);},'khizg':_0x56ae('‮36','c)52'),'eMCME':_0x56ae('‮37','alZY'),'WaIRO':function(_0x5a75d9,_0xcc859d){return _0x5a75d9===_0xcc859d;},'jdAzE':function(_0x4a396c,_0x58cb87){return _0x4a396c===_0x58cb87;},'aYsSh':'PjSiY1JxrbfUjTuPAc8aiprGPqx','aHotv':_0x56ae('‮38','YzX5'),'vSDYr':function(_0x5391f9,_0x11af19){return _0x5391f9===_0x11af19;},'WgqcX':function(_0x162b4a,_0x5ef7e8,_0xc48226){return _0x162b4a(_0x5ef7e8,_0xc48226);},'tLfon':_0x56ae('‫39','to#V'),'KSowt':function(_0x2cf77a,_0x181b41){return _0x2cf77a!==_0x181b41;},'ecIKk':_0x56ae('‫3a','1@VP'),'UtgkO':'queryInteractiveRewardInfo','CAiBh':function(_0x3d7738,_0x5c05d2){return _0x3d7738===_0x5c05d2;},'uhXij':function(_0x17f6ee,_0x449be4){return _0x17f6ee>_0x449be4;}};let _0x2af126,_0x216255,_0x1b8053;let _0x184453=await doApi(_0x2eaeeb['xJzlP'],{'geo':null,'mcChannel':0x0,'encryptProjectId':_0x2eaeeb[_0x56ae('‫3b','d1ov')],'sourceCode':_0x2eaeeb[_0x56ae('‫3c','y1hR')],'ext':{'isQueryTrailInfo':!![],'needNum':0x14,'recentRewardInAssignmentIds':[]}});doInteractiveAssignment=await _0x2eaeeb[_0x56ae('‮3d','zS1i')](doApi,_0x2eaeeb[_0x56ae('‮3e','AGdJ')],{'geo':null,'mcChannel':0x0,'encryptProjectId':_0x56ae('‫3f','d1ov'),'encryptAssignmentId':_0x2eaeeb[_0x56ae('‫40','J)Rk')],'sourceCode':'aceacesy20221130','itemId':'','actionType':'','completionFlag':!![]});if(_0x2eaeeb[_0x56ae('‮41','@07l')](doInteractiveAssignment[_0x56ae('‫42','Aw^[')],'0')){if(_0x2eaeeb[_0x56ae('‫43','o^2i')](_0x56ae('‫44','r%Vd'),_0x56ae('‫45','QB5r'))){for(let _0x1f88ef of Object['keys'](doInteractiveAssignment[_0x56ae('‮46','JLkj')][_0x56ae('‫47','z&gp')])){let _0x56f175=doInteractiveAssignment[_0x56ae('‮48','pH6G')][_0x56ae('‫49','yWm1')][_0x1f88ef];console['log'](doInteractiveAssignment[_0x56ae('‮4a','alZY')]+_0x56ae('‫4b','uZzh')+_0x56f175['quantityDetails'][0x0]['quantity']+_0x56f175[_0x56ae('‫4c','[ghC')][0x0][_0x56ae('‫4d','HKQm')]);}}else{console['log'](_0x2eaeeb[_0x56ae('‫4e','pH6G')]);}}else{console[_0x56ae('‫4f','z&gp')](JSON[_0x56ae('‫50','z&gp')](doInteractiveAssignment));}await $[_0x56ae('‫51','2$k]')](0x7d0);doInteractiveAssignment=await doApi(_0x2eaeeb['khizg'],{'geo':null,'mcChannel':0x0,'encryptProjectId':_0x2eaeeb[_0x56ae('‫52','1@VP')],'encryptAssignmentId':_0x2eaeeb[_0x56ae('‫53','l]ym')],'sourceCode':'aceacesy20221130','itemId':_0x2eaeeb[_0x56ae('‮54','r%Vd')],'actionType':'','completionFlag':!![]});if(_0x2eaeeb[_0x56ae('‫55','hX8O')](doInteractiveAssignment[_0x56ae('‫56','z&gp')],'0')){if(_0x2eaeeb['vSDYr']('lDhaq',_0x56ae('‮57','JLkj'))){for(let _0x11b186 of Object[_0x56ae('‮1','38sw')](doInteractiveAssignment[_0x56ae('‫58','cEHm')][_0x56ae('‫59','NRy7')])){let _0x56f175=doInteractiveAssignment['rewardsInfo']['successRewards'][_0x11b186];console[_0x56ae('‮5a','pteQ')](doInteractiveAssignment['msg']+_0x56ae('‫5b','EFB0')+_0x56f175[_0x56ae('‫5c','pH6G')][0x0]['quantity']+_0x56f175[_0x56ae('‫5d','hX8O')][0x0][_0x56ae('‫5e','[xL1')]);}}else{for(let _0x2dc776 of Object[_0x56ae('‫5f','$8Zz')](doInteractiveAssignment['rewardsInfo'][_0x56ae('‫59','NRy7')])){let _0x362d54=doInteractiveAssignment['rewardsInfo']['successRewards'][_0x2dc776];console[_0x56ae('‮60','AGdJ')](doInteractiveAssignment[_0x56ae('‫61','to#V')]+',获得'+_0x362d54[_0x56ae('‮62','[xL1')][0x0]['quantity']+_0x362d54[_0x56ae('‮63','38sw')][0x0][_0x56ae('‮64','dMv3')]);}}}else{console[_0x56ae('‮65','z]4Q')](JSON[_0x56ae('‫50','z&gp')](doInteractiveAssignment));}await $['wait'](0x7d0);doInteractiveAssignment=await _0x2eaeeb['WgqcX'](doApi,'doInteractiveAssignment',{'geo':null,'mcChannel':0x0,'encryptProjectId':_0x2eaeeb[_0x56ae('‫66','dMv3')],'encryptAssignmentId':_0x2eaeeb[_0x56ae('‫67','to#V')],'sourceCode':_0x2eaeeb[_0x56ae('‫68','JLkj')],'itemId':_0x2eaeeb['tLfon'],'actionType':'','completionFlag':!![]});if(_0x2eaeeb['vSDYr'](doInteractiveAssignment[_0x56ae('‮69','R$%2')],'0')){for(let _0x4efad7 of Object['keys'](doInteractiveAssignment['rewardsInfo']['successRewards'])){if(_0x2eaeeb['KSowt']('XUJxs',_0x2eaeeb[_0x56ae('‮6a','[xL1')])){$[_0x56ae('‮6b','QB5r')](err);}else{let _0x56f175=doInteractiveAssignment[_0x56ae('‫6c','YzX5')][_0x56ae('‮6d','38sw')][_0x4efad7];console[_0x56ae('‮6e','A$)2')](doInteractiveAssignment[_0x56ae('‫6f','4%An')]+_0x56ae('‮70','o^2i')+_0x56f175[_0x56ae('‫4c','[ghC')][0x0][_0x56ae('‫71','zS1i')]+_0x56f175[_0x56ae('‮62','[xL1')][0x0][_0x56ae('‮72','J)Rk')]);}}}else{console['log'](JSON[_0x56ae('‫73','T921')](doInteractiveAssignment));}let _0x1d4d07=await _0x2eaeeb[_0x56ae('‮74','yD16')](doApi,_0x2eaeeb['UtgkO'],{'geo':null,'mcChannel':0x0,'encryptProjectId':_0x2eaeeb[_0x56ae('‮75','[xL1')],'encryptAssignmentIds':[],'sourceCode':_0x2eaeeb[_0x56ae('‫76','dMv3')],'ext':{'needExchangeRestScore':'1','detailTypeFlag':0x1}});let _0x132f85,_0x3c2a11;if(_0x2eaeeb[_0x56ae('‮77','yD16')](_0x1d4d07[_0x56ae('‫78','yD16')],'0')){_0x132f85=0x3;console['log'](_0x56ae('‫79','JLkj')+_0x132f85+'次');for(let _0xc37a37=_0x132f85;_0x2eaeeb[_0x56ae('‮7a','U4Dx')](_0xc37a37,0x0);_0xc37a37--){let _0x489e58=await doApi(_0x2eaeeb[_0x56ae('‫7b','m%3e')],{'geo':null,'mcChannel':0x0,'encryptProjectId':_0x56ae('‮7c','pH6G'),'encryptAssignmentId':'3VTpMXV8Grh3edScMdT7naEd1MDk','sourceCode':_0x2eaeeb[_0x56ae('‮7d','J)Rk')],'itemId':'','actionType':'','completionFlag':!![],'ext':{'exchangeNum':0x1}});console['log'](JSON[_0x56ae('‫7e','gKH#')](_0x489e58));await $[_0x56ae('‫7f','c0$n')](0x7d0);}}}function doApi(_0x5a644f,_0x1696de){var _0x457bbd={'pURsm':function(_0x2ac443,_0x1f71c2){return _0x2ac443(_0x1f71c2);},'kGCTB':_0x56ae('‫80','Jd%h'),'KhYgZ':function(_0x693ecd,_0xa52efe){return _0x693ecd!==_0xa52efe;},'FpIhx':function(_0x59f213,_0x256b95){return _0x59f213!==_0x256b95;},'tFftX':function(_0x4b0d44,_0x151abc){return _0x4b0d44===_0x151abc;},'CYohE':_0x56ae('‮81','m%3e'),'vECYo':function(_0x1f2eaa,_0x9c7523){return _0x1f2eaa(_0x9c7523);},'UAKqo':_0x56ae('‮82','NRy7'),'rrWYS':_0x56ae('‮83','JLkj'),'rxUfA':_0x56ae('‫84','2$k]'),'JBGXK':_0x56ae('‫85','to#V'),'oChoS':'./USER_AGENTS','axtbB':'JDUA','vhbwr':'jdapp;iPhone;9.4.4;14.3;network/4g;Mozilla/5.0\x20(iPhone;\x20CPU\x20iPhone\x20OS\x2014_3\x20like\x20Mac\x20OS\x20X)\x20AppleWebKit/605.1.15\x20(KHTML,\x20like\x20Gecko)\x20Mobile/15E148;supportJDSHWK/1','YkJgf':_0x56ae('‮86','4%An'),'ILXua':_0x56ae('‫87','hX8O')};return new Promise(_0x15ff0f=>{var _0x3d7d73={'EnOgt':function(_0x19a210,_0x1fbf62){return _0x457bbd['pURsm'](_0x19a210,_0x1fbf62);},'ZGmYt':function(_0x58e827,_0x5b216a){return _0x58e827===_0x5b216a;},'iRHPz':_0x457bbd['kGCTB'],'PodmJ':function(_0x1e31f1){return _0x1e31f1();},'ASwzC':function(_0x5e3339,_0x4eda19){return _0x457bbd['KhYgZ'](_0x5e3339,_0x4eda19);},'KMvxs':_0x56ae('‫88','z&gp'),'cMmxs':function(_0x3c76f6,_0x5c3533){return _0x457bbd['FpIhx'](_0x3c76f6,_0x5c3533);},'VUpgZ':function(_0x55a8c5,_0xee21d9){return _0x457bbd[_0x56ae('‫89','Aw^[')](_0x55a8c5,_0xee21d9);},'fzXUm':_0x56ae('‮8a','38sw'),'dVLfT':_0x457bbd[_0x56ae('‮8b','dMv3')]};let _0x33adc3={'url':_0x56ae('‮8c','bJe^')+_0x5a644f,'body':_0x56ae('‫8d','*WPM')+_0x457bbd[_0x56ae('‮8e','r%Vd')](encodeURIComponent,JSON['stringify'](_0x1696de))+_0x56ae('‫8f','Lk@q')+Date[_0x56ae('‫90','T*r&')](),'headers':{'Host':_0x457bbd[_0x56ae('‫91','NRy7')],'Accept':_0x56ae('‫92','YzX5'),'Content-Type':_0x457bbd[_0x56ae('‫93','U4Dx')],'Origin':_0x457bbd['rxUfA'],'Accept-Language':_0x457bbd['JBGXK'],'User-Agent':$['isNode']()?process[_0x56ae('‫94','Lk@q')][_0x56ae('‮95','$8Zz')]?process[_0x56ae('‫96','U4Dx')]['JD_USER_AGENT']:_0x457bbd['vECYo'](require,_0x457bbd[_0x56ae('‮97','1PQB')])['USER_AGENT']:$[_0x56ae('‫98','Lk@q')](_0x457bbd['axtbB'])?$[_0x56ae('‮99','l]ym')](_0x56ae('‮9a','*WPM')):_0x457bbd[_0x56ae('‫9b','r%Vd')],'Referer':_0x457bbd[_0x56ae('‫9c','r%Vd')],'Accept-Encoding':_0x457bbd['ILXua'],'Cookie':cookie}};$[_0x56ae('‫9d','o^2i')](_0x33adc3,(_0x4ee019,_0x587fd8,_0x4491ef)=>{var _0x52abeb={'dWwxn':function(_0x1ed851,_0x4dd601){return _0x3d7d73[_0x56ae('‮9e','l]ym')](_0x1ed851,_0x4dd601);}};try{if(_0x4ee019){if(_0x3d7d73[_0x56ae('‫9f','JLkj')]('iksgN',_0x3d7d73[_0x56ae('‮a0','z&gp')])){console[_0x56ae('‫a1','o^2i')](JSON[_0x56ae('‫a2','yWm1')](_0x4ee019));console[_0x56ae('‫a3','gKH#')]($[_0x56ae('‮a4','*WPM')]+'\x20'+_0x5a644f+_0x56ae('‮a5','hX8O'));_0x3d7d73[_0x56ae('‫a6','uZzh')](_0x15ff0f);}else{console['log'](e);$['msg']($[_0x56ae('‫a7','38sw')],'',_0x56ae('‫a8','y1hR'));return[];}}else{if(_0x3d7d73[_0x56ae('‮a9','o^2i')](safeGet,_0x4491ef)){if(_0x3d7d73[_0x56ae('‫aa','to#V')](_0x3d7d73[_0x56ae('‮ab','HKQm')],_0x56ae('‫ac','T921'))){_0x4491ef=JSON['parse'](_0x4491ef);}else{_0x52abeb[_0x56ae('‮ad','T921')](_0x15ff0f,_0x4491ef);}}}}catch(_0x24caf5){if(_0x3d7d73[_0x56ae('‫ae','@07l')]('GirfJ','qhOkX')){$['logErr'](_0x24caf5,_0x587fd8);_0x15ff0f();}else{let _0x3dd15e=doInteractiveAssignment[_0x56ae('‮af','pteQ')]['successRewards'][key];console[_0x56ae('‫b0','1@VP')](doInteractiveAssignment[_0x56ae('‮b1','38sw')]+_0x56ae('‮b2','38sw')+_0x3dd15e['quantityDetails'][0x0][_0x56ae('‫b3','gKH#')]+_0x3dd15e['quantityDetails'][0x0]['rewardName']);}}finally{if(_0x3d7d73[_0x56ae('‮b4','yD16')](_0x3d7d73[_0x56ae('‫b5','yD16')],_0x3d7d73[_0x56ae('‮b6','dMv3')])){$['isLogin']=![];return;}else{_0x3d7d73['EnOgt'](_0x15ff0f,_0x4491ef);}}});});}function TotalBean(){var _0x1754c8={'gyxAY':_0x56ae('‮b7','d1ov'),'cgzox':_0x56ae('‮b8','z]4Q'),'dIgrS':_0x56ae('‫b9','A$)2'),'ubwtF':function(_0x539ad9,_0x360306){return _0x539ad9===_0x360306;},'QVHIL':_0x56ae('‫ba','EFB0'),'fRvOv':'userInfo','bDMuf':function(_0x9ff383,_0x1a8ce6){return _0x9ff383!==_0x1a8ce6;},'KIHbX':_0x56ae('‮bb','cEHm'),'UbaBW':_0x56ae('‫bc','[ghC'),'PsZjs':function(_0x7412c){return _0x7412c();},'ORLtG':_0x56ae('‫bd','Aw^['),'Beola':_0x56ae('‫be','yWm1'),'hdAdl':_0x56ae('‮bf','pH6G'),'OUxUh':function(_0x34ff77,_0x830d3a){return _0x34ff77(_0x830d3a);},'wwBps':_0x56ae('‮c0','1@VP'),'bsUeu':_0x56ae('‫c1','JLkj'),'VNEsx':_0x56ae('‮c2','R$%2'),'sCngz':_0x56ae('‫c3','[xL1')};return new Promise(async _0x3a2238=>{var _0xe6e376={'DpViE':_0x1754c8[_0x56ae('‮c4','T921')],'BBpqZ':_0x56ae('‫c5','U4Dx'),'yHtaY':_0x1754c8[_0x56ae('‮c6','gKH#')],'pJkdW':_0x1754c8['dIgrS'],'uoGmU':_0x56ae('‫c7','c0$n'),'ErwYE':function(_0x5cacc0,_0x15f892){return _0x1754c8[_0x56ae('‮c8','zS1i')](_0x5cacc0,_0x15f892);},'IrHEQ':_0x1754c8['QVHIL'],'NfKor':_0x1754c8['fRvOv'],'dbmhw':function(_0x34f612,_0x2d6673){return _0x1754c8[_0x56ae('‮c9','yD16')](_0x34f612,_0x2d6673);},'OjXwg':_0x1754c8['KIHbX'],'EWMWS':'pnjuE','khNJj':_0x1754c8[_0x56ae('‮ca','@07l')],'afezG':function(_0xb59659){return _0x1754c8['PsZjs'](_0xb59659);}};const _0x27d340={'url':_0x1754c8['ORLtG'],'headers':{'Host':_0x1754c8['Beola'],'Accept':_0x1754c8['hdAdl'],'Connection':_0x56ae('‮cb','JLkj'),'Cookie':cookie,'User-Agent':$['isNode']()?process[_0x56ae('‫cc','c0$n')][_0x56ae('‫cd','z]4Q')]?process['env'][_0x56ae('‮ce','2$k]')]:_0x1754c8[_0x56ae('‮cf','yD16')](require,_0x1754c8['wwBps'])[_0x56ae('‮d0','[xL1')]:$['getdata']('JDUA')?$[_0x56ae('‮d1','to#V')](_0x56ae('‮d2','38sw')):_0x1754c8[_0x56ae('‫d3','pteQ')],'Accept-Language':'zh-cn','Referer':_0x1754c8[_0x56ae('‮d4','Lk@q')],'Accept-Encoding':_0x1754c8[_0x56ae('‫d5','pteQ')]}};$['get'](_0x27d340,(_0x9583dd,_0x2fe3a7,_0x18e3b3)=>{try{if(_0xe6e376['BBpqZ']===_0xe6e376[_0x56ae('‮d6','z]4Q')]){$['done']();}else{if(_0x9583dd){if(_0xe6e376[_0x56ae('‫d7','uZzh')]!==_0xe6e376[_0x56ae('‫d8','T921')]){$[_0x56ae('‫d9','HKQm')](_0x9583dd);}else{cookiesArr[_0x56ae('‫da','alZY')](jdCookieNode[item]);}}else{if(_0x18e3b3){_0x18e3b3=JSON[_0x56ae('‫db','JLkj')](_0x18e3b3);if(_0xe6e376[_0x56ae('‮dc','38sw')](_0x18e3b3[_0xe6e376[_0x56ae('‮dd','gKH#')]],0x3e9)){if(_0xe6e376[_0x56ae('‮de','cEHm')]('nABVe',_0x56ae('‫df','cEHm'))){$['isLogin']=![];return;}else{$[_0x56ae('‫e0','zS1i')](e);}}if(_0x18e3b3[_0xe6e376[_0x56ae('‮e1','J)Rk')]]===0x0&&_0x18e3b3[_0x56ae('‮e2','J)Rk')]&&_0x18e3b3[_0x56ae('‮e3','fr02')][_0x56ae('‮e4','r%Vd')](_0xe6e376[_0x56ae('‮e5','NRy7')])){$['nickName']=_0x18e3b3[_0x56ae('‫e6','m%3e')]['userInfo'][_0x56ae('‫e7','yWm1')]['nickname'];}}else{if(_0xe6e376[_0x56ae('‮e8','c)52')](_0xe6e376['OjXwg'],_0xe6e376['EWMWS'])){console[_0x56ae('‮e9','c0$n')]('京东服务器返回空数据');}else{try{return JSON[_0x56ae('‫ea','[xL1')](str);}catch(_0x298620){console[_0x56ae('‮eb','Jd%h')](_0x298620);$['msg']($[_0x56ae('‫ec','c0$n')],'',_0xe6e376['DpViE']);return[];}}}}}}catch(_0x30a4dc){$[_0x56ae('‮ed','c0$n')](_0x30a4dc);}finally{if(_0x56ae('‫ee','o^2i')===_0xe6e376['khNJj']){_0xe6e376[_0x56ae('‫ef','*WPM')](_0x3a2238);}else{_0x18e3b3=JSON['parse'](_0x18e3b3);}}});});}function safeGet(_0x346236){var _0x5222a1={'HxsxI':_0x56ae('‮f0','NRy7'),'YdPJJ':function(_0x366766,_0xff9d23){return _0x366766===_0xff9d23;},'lOiMV':_0x56ae('‫f1','c)52')};try{if(_0x5222a1[_0x56ae('‮f2','[ghC')]===_0x5222a1[_0x56ae('‮f3','38sw')]){if(typeof JSON['parse'](_0x346236)=='object'){return!![];}}else{let _0x6c88bf=doInteractiveAssignment[_0x56ae('‮f4','yD16')][_0x56ae('‫f5','$8Zz')][key];console[_0x56ae('‫f6','@07l')](doInteractiveAssignment[_0x56ae('‮f7','z&gp')]+',获得'+_0x6c88bf[_0x56ae('‫f8','y1hR')][0x0]['quantity']+_0x6c88bf[_0x56ae('‫f8','y1hR')][0x0][_0x56ae('‫5e','[xL1')]);}}catch(_0x3e3b5f){if(_0x5222a1[_0x56ae('‮f9','HKQm')](_0x5222a1[_0x56ae('‫fa','c0$n')],'LIABX')){console[_0x56ae('‫fb','uZzh')](_0x3e3b5f);console['log'](_0x56ae('‮fc','R$%2'));return![];}else{console[_0x56ae('‮fd','pH6G')](_0x3e3b5f);console[_0x56ae('‮fe','yWm1')](_0x56ae('‮ff','pH6G'));return![];}}}function jsonParse(_0x1629a9){var _0x494351={'lzbca':_0x56ae('‮100','AGdJ'),'KtKQE':function(_0x2f8c74,_0x16a8c4){return _0x2f8c74!==_0x16a8c4;},'sFUIO':'wThfp','xpeTm':function(_0x19e176,_0x300474){return _0x19e176===_0x300474;},'qjFut':_0x56ae('‫101','EFB0'),'iwddn':_0x56ae('‫102','@07l')};if(typeof _0x1629a9==_0x494351['lzbca']){if(_0x494351[_0x56ae('‮103','fr02')](_0x56ae('‫104','m%3e'),_0x494351[_0x56ae('‫105','Jd%h')])){for(let _0x5845c1 of Object[_0x56ae('‮106','4%An')](doInteractiveAssignment[_0x56ae('‮48','pH6G')][_0x56ae('‮107','m%3e')])){let _0x4fbc7a=doInteractiveAssignment[_0x56ae('‫108','T921')][_0x56ae('‫f5','$8Zz')][_0x5845c1];console[_0x56ae('‮65','z]4Q')](doInteractiveAssignment['msg']+_0x56ae('‫109','gKH#')+_0x4fbc7a[_0x56ae('‮10a','1@VP')][0x0][_0x56ae('‫10b','1@VP')]+_0x4fbc7a['quantityDetails'][0x0][_0x56ae('‮10c','bJe^')]);}}else{try{return JSON['parse'](_0x1629a9);}catch(_0xb369a0){if(_0x494351[_0x56ae('‫10d','T921')](_0x494351['qjFut'],_0x56ae('‫10e','*WPM'))){console['log'](_0xb369a0);$[_0x56ae('‫10f','[ghC')]($[_0x56ae('‫110','AGdJ')],'',_0x494351[_0x56ae('‫111','38sw')]);return[];}else{console['log'](JSON['stringify'](doInteractiveAssignment));}}}}};_0xodr='jsjiami.com.v6';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
